if(!Array.prototype.map)Array.prototype.map=function(a,b){var c=this.length>>>0;if(typeof a!=="function")throw new TypeError;for(var e=Array(c),h=0;h<c;h++)h in this&&(e[h]=a.call(b,this[h],h,this));return e};function BigInteger(a,b){if(!(this instanceof BigInteger)){if(a instanceof BigInteger)return a;else if(typeof a==="undefined")return BigInteger.ZERO;return BigInteger.parse(a)}for(;a.length&&!a[a.length-1];)--a.length;this._d=a;this._s=a.length?b||1:0}BigInteger.ZERO=new BigInteger([],0);BigInteger.ONE=new BigInteger([1],1);BigInteger.M_ONE=new BigInteger(BigInteger.ONE._d,-1);BigInteger._0=BigInteger.ZERO;BigInteger._1=BigInteger.ONE;BigInteger.small=[BigInteger.ZERO,BigInteger.ONE,new BigInteger([2],1),new BigInteger([3],1),new BigInteger([4],1),new BigInteger([5],1),new BigInteger([6],1),new BigInteger([7],1),new BigInteger([8],1),new BigInteger([9],1),new BigInteger([0,1],1),new BigInteger([1,1],1),new BigInteger([2,1],1),new BigInteger([3,1],1),new BigInteger([4,1],1),new BigInteger([5,1],1),new BigInteger([6,1],1),new BigInteger([7,1],1),new BigInteger([8,1],1),new BigInteger([9,1],1),new BigInteger([0,2],1),new BigInteger([1,2],1),new BigInteger([2,2],1),new BigInteger([3,2],1),new BigInteger([4,2],1),new BigInteger([5,2],1),new BigInteger([6,2],1),new BigInteger([7,2],1),new BigInteger([8,2],1),new BigInteger([9,2],1),new BigInteger([0,3],1),new BigInteger([1,3],1),new BigInteger([2,3],1),new BigInteger([3,3],1),new BigInteger([4,3],1),new BigInteger([5,3],1),new BigInteger([6,3],1)];BigInteger.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");BigInteger.prototype.toString=function(a){a=+a||10;if(a<2||a>36)throw Error("illegal radix "+a+".");if(this._s===0)return"0";if(a===10)return(this._s<0?"-":"")+(this._d.slice().reverse().join("")||"0");else{for(var b=BigInteger.digits,a=BigInteger(a),c=this._s,e=this.abs(),h=[],g;e._s!==0;)g=e.divRem(a),e=g[0],g=g[1],h.push(b[g]);return(c<0?"-":"")+h.reverse().join("")}};BigInteger.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/];BigInteger.parse=function(a,b){function c(a){a=a.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e");return a.replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(a,b,e,d,c){var c=+c,f=c<0,g=e.length+c,a=(f?e:d).length,c=(c=Math.abs(c))>=a?c-a+f:0,a=Array(c+1).join("0");e+=d;return(b||"")+(f?e=a+e:e+=a).substr(0,g+=f?a.length:0)+(g<e.length?"."+e.substr(g):"")})}a=a.toString();if(typeof b==="undefined"||+b===10)a=c(a);var e=/^([+\-]?)(0[xXcCbB])?([0-9A-Za-z]*)(?:\.\d*)?$/.exec(a);if(e){var h=e[1]||"+",g=e[2]||"",e=e[3]||"";if(typeof b==="undefined")b=g==="0x"||g==="0X"?16:g==="0c"||g==="0C"?8:g==="0b"||g==="0B"?2:10;else if(b<2||b>36)throw Error("Illegal radix "+b+".");b=+b;if(!BigInteger.radixRegex[b].test(e))throw Error("Bad digit for radix "+b);e=e.replace(/^0+/,"").split("");if(e.length===0)return BigInteger.ZERO;h=h==="-"?-1:1;if(b===10)return new BigInteger(e.map(Number).reverse(),h);for(var g=BigInteger.ZERO,b=BigInteger(b),f=BigInteger.small,d=0;d<e.length;d++)g=g.multiply(b).add(f[parseInt(e[d],36)]);return new BigInteger(g._d,h)}else throw Error("Invalid BigInteger format: "+a);};BigInteger.prototype.add=function(a){if(this._s===0)return BigInteger(a);a=BigInteger(a);if(a._s===0)return this;if(this._s!==a._s)return a=a.negate(),this.subtract(a);for(var b=this._d,a=a._d,c=b.length,e=a.length,h=Array(Math.max(c,e)+1),g=Math.min(c,e),f=0,d=0;d<g;d++)f=b[d]+a[d]+f,h[d]=f%10,f=f/10|0;e>c&&(b=a,c=e);for(d=g;f&&d<c;d++)f=b[d]+f,h[d]=f%10,f=f/10|0;for(f&&(h[d]=f);d<c;d++)h[d]=b[d];return new BigInteger(h,this._s)};BigInteger.prototype.negate=function(){return new BigInteger(this._d,-this._s)};BigInteger.prototype.abs=function(){return this._s<0?this.negate():this};BigInteger.prototype.subtract=function(a){if(this._s===0)return BigInteger(a).negate();a=BigInteger(a);if(a._s===0)return this;if(this._s!==a._s)return a=a.negate(),this.add(a);var b=this,c;this._s<0&&(c=b,b=new BigInteger(a._d,1),a=new BigInteger(c._d,1));var e=b.compareAbs(a);if(e===0)return BigInteger.ZERO;else e<0&&(c=a,a=b,b=c);b=b._d;a=a._d;c=b.length;var h=a.length,g=Array(c),f=0,d,i;for(d=0;d<h;d++)i=b[d]-f-a[d],i<0?(i+=10,f=1):f=0,g[d]=i;for(d=h;d<c;d++){i=b[d]-f;if(i<0)i+=10;else{g[d++]=i;break}g[d]=i}for(;d<c;d++)g[d]=b[d];return new BigInteger(g,e)};(function(){function a(a,b){for(var h=a._d,g=h.slice(),f=0;;){var d=(h[f]||0)+1;g[f]=d%10;if(d<=9)break;++f}return new BigInteger(g,b)}function b(a,b){for(var h=a._d,g=h.slice(),f=0;;){var d=(h[f]||0)-1;if(d<0)g[f]=d+10;else{g[f]=d;break}++f}return new BigInteger(g,b)}BigInteger.prototype.next=function(){switch(this._s){case 0:return BigInteger.ONE;case -1:return b(this,-1);default:return a(this,1)}};BigInteger.prototype.prev=function(){switch(this._s){case 0:return BigInteger.M_ONE;case -1:return a(this,-1);default:return b(this,1)}}})();BigInteger.prototype.compareAbs=function(a){if(this===a)return 0;a=BigInteger(a);if(this._s===0)return a._s!==0?-1:0;if(a._s===0)return 1;var b=this._d.length,c=a._d.length;if(b<c)return-1;else if(b>c)return 1;c=this._d;a=a._d;for(b-=1;b>=0;b--)if(c[b]!==a[b])return c[b]<a[b]?-1:1;return 0};BigInteger.prototype.compare=function(a){if(this===a)return 0;a=BigInteger(a);if(this._s===0)return-a._s;return this._s===a._s?this.compareAbs(a)*this._s:this._s};BigInteger.prototype.isUnit=function(){return this===BigInteger.ONE||this===BigInteger.M_ONE||this._d.length===1&&this._d[0]===1};BigInteger.prototype.multiply=function(a){if(this._s===0)return BigInteger.ZERO;a=BigInteger(a);if(a._s===0)return BigInteger.ZERO;if(this.isUnit()){if(this._s<0)return a.negate();return a}if(a.isUnit()){if(a._s<0)return this.negate();return this}if(this===a)return this.square();var b=this._d.length>=a._d.length,c=(b?this:a)._d,b=(b?a:this)._d,e=c.length,h=b.length,g=e+h,f=Array(g),d;for(d=0;d<g;d++)f[d]=0;for(d=0;d<h;d++){for(var g=0,i=b[d],l=e+d,k,j=d;j<l;j++)k=f[j]+i*c[j-d]+g,g=k/10|0,f[j]=k%10|0;g&&(k=f[j]+g,f[j]=k%10)}return new BigInteger(f,this._s*a._s)};BigInteger.prototype.multiplySingleDigit=function(a,b){if(a===0||this._s===0)return BigInteger.ZERO;if(a===1)return this;if(b[a])return b[a];var c;if(this._d.length===1){c=this._d[0]*a;if(c>9)return new BigInteger([c%10|0,c/10|0],1);b[a]=BigInteger.small[c];return b[a]}if(a===2)return b[a]=this.add(this),b[a];if(this.isUnit())return b[a]=BigInteger.small[a],b[a];var e=this._d,h=e.length;c=h+1;for(var g=Array(c),f=0;f<c;f++)g[f]=0;for(var d=f=0;d<h;d++)c=a*e[d]+f,f=c/10|0,g[d]=c%10|0;f&&(g[d]=f%10);b[a]=new BigInteger(g,1);return b[a]};BigInteger.prototype.square=function(){if(this._s===0)return BigInteger.ZERO;if(this.isUnit())return BigInteger.ONE;var a=this._d,b=a.length,c=Array(b+b+1),e,h,g,f;for(f=0;f<b;f++)g=f*2,e=a[f]*a[f],h=e/10|0,c[g]=e%10,c[g+1]=h;for(f=0;f<b;f++){h=0;g=f*2+1;for(var d=f+1;d<b;d++,g++)e=a[d]*a[f]*2+c[g]+h,h=e/10|0,c[g]=e%10;g=b+f;e=h+c[g];h=e/10|0;c[g]=e%10;c[g+1]+=h}return new BigInteger(c,1)};BigInteger.prototype.divide=function(a){return this.divRem(a)[0]};BigInteger.prototype.remainder=function(a){return this.divRem(a)[1]};BigInteger.prototype.divRem=function(a){a=BigInteger(a);if(a._s===0)throw Error("Divide by zero");if(this._s===0)return[BigInteger.ZERO,BigInteger.ZERO];if(a._d.length===1)return this.divRemSmall(a._s*a._d[0]);switch(this.compareAbs(a)){case 0:return[this._s===a._s?BigInteger.ONE:BigInteger.M_ONE,BigInteger.ZERO];case -1:return[BigInteger.ZERO,this]}var b=this._s*a._s,c=a.abs(),e=Array(10),h=this._d.slice(),g=[],f,d=new BigInteger([],1);for(d._s=1;h.length;)if(d._d.unshift(h.pop()),d=new BigInteger(d._d,1),d.compareAbs(a)<0)g.push(0);else{f=d._s===0?0:9;do{var i=c.multiplySingleDigit(f,e);if(i.compareAbs(d)<=0)break;f--}while(f);g.push(f);if(f)f=d.subtract(i),d._d=f._d.slice()}return[new BigInteger(g.reverse(),b),new BigInteger(d._d,this._s)]};BigInteger.prototype.divRemSmall=function(a){a=+a;if(a===0)throw Error("Divide by zero");var b=this._s*(a<0?-1:1),a=Math.abs(a);if(a<1||a>9)throw Error("Argument out of range");if(this._s===0)return[BigInteger.ZERO,BigInteger.ZERO];if(a===1||a===-1)return[b===1?this.abs():new BigInteger(this._d,b),BigInteger.ZERO];if(this._d.length===1){var c=BigInteger.small[this._d[0]/a|0],a=BigInteger.small[this._d[0]%a|0];b<0&&(c=c.negate());this._s<0&&(a=a.negate());return[c,a]}for(var e=this._d.slice(),c=Array(e.length),h=0,g=0,f=0,d;e.length;)h=h*10+e[e.length-1],h<a?(c[f++]=0,e.pop(),g=10*g+h):(d=h===0?0:h/a|0,g=h-a*d,(c[f++]=d)?(e.pop(),h=g):e.pop());a=BigInteger.small[g];this._s<0&&(a=a.negate());return[new BigInteger(c.reverse(),b),a]};BigInteger.prototype.isEven=function(){var a=this._d;return this._s===0||a.length===0||a[0]%2===0};BigInteger.prototype.isOdd=function(){return!this.isEven()};BigInteger.prototype.sign=function(){return this._s};BigInteger.prototype.isPositive=function(){return this._s>0};BigInteger.prototype.isNegative=function(){return this._s<0};BigInteger.prototype.isZero=function(){return this._s===0};BigInteger.prototype.exp10=function(a){a=+a;if(a===0)return this;if(Math.abs(a)>Number(BigInteger.MAX_EXP))throw Error("exponent too large in BigInteger.exp10");if(a>0){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return new BigInteger(b.concat(this._d),this._s)}return new BigInteger(this._d.slice(-a,this._d.length),this._s)};BigInteger.prototype.pow=function(a){if(this.isUnit())return this._s>0?this:BigInteger(a).isOdd()?this:this.negate();a=BigInteger(a);if(a._s===0)return BigInteger.ONE;else if(a._s<0)if(this._s===0)throw Error("Divide by zero");else return BigInteger.ZERO;if(this._s===0)return BigInteger.ZERO;if(a.isUnit())return this;if(a.compareAbs(BigInteger.MAX_EXP)>0)throw Error("exponent too large in BigInteger.pow");for(var b=this,c=BigInteger.ONE,e=BigInteger.small[2];a.isPositive();){if(a.isOdd()&&(c=c.multiply(b),a.isUnit()))break;b=b.square();a=a.divide(e)}return c};BigInteger.prototype.modPow=function(a,b){for(var c=BigInteger.ONE,e=this;a.isPositive();)a.isOdd()&&(c=c.multiply(e).remainder(b)),a=a.divide(BigInteger.small[2]),a.isPositive()&&(e=e.square().remainder(b));return c};BigInteger.prototype.valueOf=function(){return parseInt(this.toString(),10)};BigInteger.prototype.toJSValue=function(){return parseInt(this.toString(),10)};BigInteger.MAX_EXP=BigInteger(2147483647);(function(){function a(a){return function(b){return a.call(BigInteger(b))}}function b(a){return function(b,c){return a.call(BigInteger(b),BigInteger(c))}}function c(a){return function(b,c,f){return a.call(BigInteger(b),BigInteger(c),BigInteger(f))}}(function(){var e,h,g="toJSValue,isEven,isOdd,sign,isZero,isNegative,abs,isUnit,square,negate,isPositive,toString,next,prev".split(","),f="compare,remainder,divRem,subtract,add,divide,multiply,pow,compareAbs".split(","),d=["modPow"];for(e=0;e<g.length;e++)h=g[e],BigInteger[h]=a(BigInteger.prototype[h]);for(e=0;e<f.length;e++)h=f[e],BigInteger[h]=b(BigInteger.prototype[h]);for(e=0;e<d.length;e++)h=d[e],BigInteger[h]=c(BigInteger.prototype[h]);BigInteger.exp10=function(a,b){return BigInteger(a).exp10(b)}})()})();if(typeof exports!=="undefined")exports.BigInteger=BigInteger;
